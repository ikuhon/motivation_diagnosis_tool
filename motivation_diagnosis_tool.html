<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„ÇÑ„ÇãÊ∞óË®∫Êñ≠ÔºÜ„Éó„É©„É≥„Éã„É≥„Ç∞„Ç∑„Éº„Éà</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', '„Éí„É©„ÇÆ„ÉéËßí„Ç¥„Ç∑„ÉÉ„ÇØ', 'Yu Gothic', '„É°„Ç§„É™„Ç™', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            color: white;
            text-align: center;
            padding: 40px 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 50px;
        }

        .section h2 {
            color: #2c3e50;
            font-size: 1.8rem;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
        }

        .section h2:after {
            content: '';
            display: block;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4);
            margin: 10px auto;
            border-radius: 2px;
        }

        .diagnosis-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .type-group {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .type-group h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 5px;
            transition: background-color 0.2s;
        }

        .checkbox-item:hover {
            background-color: #f1f3f4;
        }

        .checkbox-item input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.2);
            accent-color: #3498db;
        }

        .checkbox-item label {
            cursor: pointer;
            font-size: 0.95rem;
        }

        .diagnosis-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            display: block;
            margin: 30px auto 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .diagnosis-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .result {
            background: linear-gradient(135deg, #a8e6cf, #7fcdcd);
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            color: #2c3e50;
            display: none;
        }

        .result h4 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            text-align: center;
        }

        .result p {
            text-align: center;
            font-size: 1rem;
        }

        .planning-sheet {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .form-group textarea {
            height: 100px;
            resize: vertical;
        }

        /* Êñ∞„Åó„ÅÑ„Ç¢„ÇØ„Ç∑„Éß„É≥„Ç¢„Ç§„ÉÜ„É† */
        .action-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .todo-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            gap: 20px;
            padding-top: 10px;
        }

        .todo-input {
            flex: 1;
            border: 3px solid #3498db;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 1.1rem;
            background: #f8f9fa;
            min-height: 50px;
            width: 70%;
        }

        .todo-input:focus {
            outline: none;
            border-color: #2980b9;
            background: white;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.2);
        }

        .todo-input::placeholder {
            color: #7f8c8d;
            font-style: italic;
        }

        .todo-checkbox {
            width: 25px;
            height: 25px;
            accent-color: #27ae60;
            cursor: pointer;
            border: 2px solid #27ae60;
            margin-top: 12px;
            flex-shrink: 0;
        }

        .todo-checkbox:focus {
            outline: 2px solid #27ae60;
            outline-offset: 2px;
        }

        .save-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            display: block;
            margin: 30px auto 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }

        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .note p {
            margin: 0;
            color: #856404;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .diagnosis-container,
            .planning-sheet {
                padding: 20px;
            }
        }

        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä „ÇÑ„ÇãÊ∞óË®∫Êñ≠ÔºÜ„Éó„É©„É≥„Éã„É≥„Ç∞</h1>
            <p>„ÅÇ„Å™„Åü„ÅÆ„ÇÑ„ÇãÊ∞ó‰Ωé‰∏ã„Çø„Ç§„Éó„ÇíË®∫Êñ≠„Åó„Å¶„ÄÅÂ∞ÇÁî®„ÅÆÂõûÂæ©„Éó„É©„É≥„Çí‰ΩúÊàê„Åó„Åæ„Åó„Çá„ÅÜ</p>
        </div>

        <div class="content">
            <!-- Ë®∫Êñ≠„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <section class="section">
                <h2>üîç „ÄêË®∫Êñ≠„Äë„ÅÇ„Å™„Åü„ÅÆ„ÇÑ„ÇãÊ∞ó‰Ωé‰∏ã„Çø„Ç§„Éó„Çí„ÉÅ„Çß„ÉÉ„ÇØÔºÅ</h2>
                
                <div class="diagnosis-container">
                    <div class="type-group">
                        <h3>üí§ „Çø„Ç§„ÉóAÔºöË∫´‰ΩìÁñ≤Âä¥Âûã</h3>
                        <div class="checkbox-item">
                            <input type="checkbox" id="a1" data-type="A">
                            <label for="a1">ÊÖ¢ÊÄßÁöÑ„Å™ÂØù‰∏çË∂≥„ÅåÁ∂ö„ÅÑ„Å¶„ÅÑ„Çã</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="a2" data-type="A">
                            <label for="a2">ÊÆãÊ•≠„ÅåÊúà30ÊôÇÈñì‰ª•‰∏ä„ÅÇ„Çã</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="a3" data-type="A">
                            <label for="a3">‰ºëÊó•„ÇÇÁñ≤„Çå„ÅåÂèñ„Çå„Å™„ÅÑ</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="a4" data-type="A">
                            <label for="a4">ËÇ©„Åì„Çä„ÇÑÈ†≠Áóõ„ÅåÈ†ªÁπÅ„Å´„ÅÇ„Çã</label>
                        </div>
                    </div>

                    <div class="type-group">
                        <h3>üë• „Çø„Ç§„ÉóBÔºö‰∫∫ÈñìÈñ¢‰øÇ„Çπ„Éà„É¨„ÇπÂûã</h3>
                        <div class="checkbox-item">
                            <input type="checkbox" id="b1" data-type="B">
                            <label for="b1">‰∏äÂè∏„ÇÑÂêåÂÉö„Å®„ÅÆÈñ¢‰øÇ„Å´ÊÇ©„Çì„Åß„ÅÑ„Çã</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="b2" data-type="B">
                            <label for="b2">ËÅ∑Â†¥„ÅßÂ≠§Á´ãÊÑü„ÇíÊÑü„Åò„Çã</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="b3" data-type="B">
                            <label for="b3">‰ºöË≠∞„ÇÑÊâì„Å°Âêà„Çè„Åõ„ÅåÊÜÇÈ¨±</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="b4" data-type="B">
                            <label for="b4">‰∫∫„Å®Ë©±„Åô„ÅÆ„ÅåÈù¢ÂÄí„Å´ÊÑü„Åò„Çã</label>
                        </div>
                    </div>

                    <div class="type-group">
                        <h3>üìà „Çø„Ç§„ÉóCÔºöË©ï‰æ°‰∏çÊ∫ÄÂûã</h3>
                        <div class="checkbox-item">
                            <input type="checkbox" id="c1" data-type="C">
                            <label for="c1">È†ëÂºµ„Çä„ÅåÊ≠£ÂΩì„Å´Ë©ï‰æ°„Åï„Çå„Å™„ÅÑ</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="c2" data-type="C">
                            <label for="c2">Áµ¶‰∏é„Å´‰∏çÊ∫Ä„Åå„ÅÇ„Çã</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="c3" data-type="C">
                            <label for="c3">ÊòáÈÄ≤„ÉªÊòáÊ†º„ÅÆË¶ãËæº„Åø„ÅåËñÑ„ÅÑ</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="c4" data-type="C">
                            <label for="c4">ÊàêÊûú„Çí‰∏ä„Åí„Å¶„ÇÇË™ç„ÇÅ„Çâ„Çå„Å™„ÅÑ</label>
                        </div>
                    </div>

                    <div class="type-group">
                        <h3>üéØ „Çø„Ç§„ÉóDÔºö‰ªï‰∫ãÂÜÖÂÆπ„Éü„Çπ„Éû„ÉÉ„ÉÅÂûã</h3>
                        <div class="checkbox-item">
                            <input type="checkbox" id="d1" data-type="D">
                            <label for="d1">‰ªï‰∫ã„Å´ËààÂë≥„ÇÑÈñ¢ÂøÉ„ÅåÊåÅ„Å¶„Å™„ÅÑ</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="d2" data-type="D">
                            <label for="d2">Âêå„Åò‰ΩúÊ•≠„ÅÆÁπ∞„ÇäËøî„Åó„Å´È£Ω„Åç„Å¶„ÅÑ„Çã</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="d3" data-type="D">
                            <label for="d3">Ëá™ÂàÜ„ÅÆÂº∑„Åø„ÇíÊ¥ª„Åã„Åõ„Å¶„ÅÑ„Å™„ÅÑ</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="d4" data-type="D">
                            <label for="d4">„ÇÑ„Çä„Åå„ÅÑ„ÇíÊÑü„Åò„Çâ„Çå„Å™„ÅÑ</label>
                        </div>
                    </div>

                    <button class="diagnosis-btn" onclick="diagnose()">Ë®∫Êñ≠ÁµêÊûú„ÇíË¶ã„Çã</button>

                    <div id="result" class="result">
                        <h4 id="result-type"></h4>
                        <p id="result-description"></p>
                    </div>
                </div>
            </section>

            <!-- „Éó„É©„É≥„Éã„É≥„Ç∞„Ç∑„Éº„Éà„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <section class="section">
                <h2>üìù „ÄêÁÑ°Êñô„ÉÜ„É≥„Éó„É¨„Éº„Éà„Äë„ÇÑ„ÇãÊ∞óÂõûÂæ©„Éó„É©„É≥„Éã„É≥„Ç∞„Ç∑„Éº„Éà</h2>
                
                <div class="planning-sheet">
                    <div class="note">
                        <p>üí° „Åì„ÅÆ„Ç∑„Éº„Éà„Çí‰Ωø„Å£„Å¶„ÄÅ„ÅÇ„Å™„Åü„Å†„Åë„ÅÆ„ÇÑ„ÇãÊ∞óÂõûÂæ©„Éó„É©„É≥„Çí‰ΩúÊàê„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇÂÆöÊúüÁöÑ„Å´Ë¶ãÁõ¥„Åô„Åì„Å®„Åß„ÄÅ„É¢„ÉÅ„Éô„Éº„Ç∑„Éß„É≥Á∂≠ÊåÅ„Å´ÂΩπÁ´ã„Å°„Åæ„Åô„ÄÇ</p>
                    </div>

                    <div class="form-group">
                        <label for="diagnosis-result">üîç „ÇÑ„ÇãÊ∞ó‰Ωé‰∏ã„ÅÆ„Çø„Ç§„Éó</label>
                        <input type="text" id="diagnosis-result" placeholder="‰∏ä„ÅÆË®∫Êñ≠ÁµêÊûú„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
                    </div>

                    <div class="form-group">
                        <label for="main-causes">üéØ ‰∏ª„Å™ÂéüÂõ†Ôºà‰∏ä‰Ωç3„Å§Ôºâ</label>
                        <textarea id="main-causes" placeholder="1. &#10;2. &#10;3. "></textarea>
                    </div>

                    <div class="form-group">
                        <label for="ideal-state">‚ú® 1„É∂ÊúàÂæå„ÅÆÁêÜÊÉ≥Áä∂ÊÖã</label>
                        <textarea id="ideal-state" placeholder="„Å©„Çì„Å™Áä∂ÊÖã„Å´„Å™„Å£„Å¶„ÅÑ„Åü„ÅÑ„Åß„Åô„ÅãÔºü"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="measurement">üìä ÈÅîÊàêÂ∫¶Ê∏¨ÂÆöÊñπÊ≥ï</label>
                        <input type="text" id="measurement" placeholder="„Å©„ÅÜ„ÇÑ„Å£„Å¶ÈÅîÊàêÂ∫¶„ÇíÊ∏¨„Çä„Åæ„Åô„ÅãÔºü">
                    </div>

                    <div class="form-group">
                        <label>üìÖ ‰ªäÈÄ±ÂÆüË∑µ„Åô„Çã„Åì„Å®</label>
                        <div class="action-section">
                            <div style="margin-bottom: 15px;">
                                <input type="text" placeholder="‰ªäÈÄ±„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥1„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" style="width: 80%; padding: 15px; border: 2px solid #3498db; border-radius: 8px; font-size: 16px; margin-right: 15px;">
                                <input type="checkbox" style="width: 20px; height: 20px;">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <input type="text" placeholder="‰ªäÈÄ±„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥2„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" style="width: 80%; padding: 15px; border: 2px solid #3498db; border-radius: 8px; font-size: 16px; margin-right: 15px;">
                                <input type="checkbox" style="width: 20px; height: 20px;">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <input type="text" placeholder="‰ªäÈÄ±„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥3„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" style="width: 80%; padding: 15px; border: 2px solid #3498db; border-radius: 8px; font-size: 16px; margin-right: 15px;">
                                <input type="checkbox" style="width: 20px; height: 20px;">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>üìÜ ‰ªäÊúàÂèñ„ÇäÁµÑ„ÇÄ„Åì„Å®</label>
                        <div class="action-section">
                            <div style="margin-bottom: 15px;">
                                <input type="text" placeholder="‰ªäÊúà„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥1„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" style="width: 80%; padding: 15px; border: 2px solid #3498db; border-radius: 8px; font-size: 16px; margin-right: 15px;">
                                <input type="checkbox" style="width: 20px; height: 20px;">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <input type="text" placeholder="‰ªäÊúà„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥2„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" style="width: 80%; padding: 15px; border: 2px solid #3498db; border-radius: 8px; font-size: 16px; margin-right: 15px;">
                                <input type="checkbox" style="width: 20px; height: 20px;">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="support-person">üë• Áõ∏Ë´áÁõ∏Êâã</label>
                        <input type="text" id="support-person" placeholder="‰ø°È†º„Åß„Åç„ÇãÁõ∏Ë´áÁõ∏Êâã„ÅÆÂêçÂâç">
                    </div>

                    <div class="form-group">
                        <label for="report-date">üìÖ ÈÄ≤ÊçóÂ†±ÂëäÊó•</label>
                        <input type="date" id="report-date">
                    </div>

                    <button class="save-btn" onclick="saveSheet()">„Éó„É©„É≥„Çí‰øùÂ≠ò„Åô„Çã</button>
                </div>
            </section>
        </div>
    </div>

    <script>
        function diagnose() {
            const types = { A: 0, B: 0, C: 0, D: 0 };
            const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
            
            checkboxes.forEach(checkbox => {
                const type = checkbox.getAttribute('data-type');
                if (type) types[type]++;
            });

            let maxType = 'A';
            let maxCount = 0;
            
            for (const [type, count] of Object.entries(types)) {
                if (count > maxCount) {
                    maxCount = count;
                    maxType = type;
                }
            }

            const typeDescriptions = {
                A: {
                    name: 'üí§ Ë∫´‰ΩìÁñ≤Âä¥Âûã',
                    description: '„ÅÇ„Å™„Åü„ÅØÂøÉË∫´„ÅÆÁñ≤Âä¥„Åå‰∏ª„Å™ÂéüÂõ†„Åß„Åô„ÄÇ„Åæ„Åö„ÅØÂçÅÂàÜ„Å™‰ºëÊÅØ„Å®Áù°Áú†„ÇíÂøÉ„Åå„Åë„ÄÅÁÑ°ÁêÜ„Çí„Åó„Å™„ÅÑÂÉç„ÅçÊñπ„ÇíÊÑèË≠ò„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ'
                },
                B: {
                    name: 'üë• ‰∫∫ÈñìÈñ¢‰øÇ„Çπ„Éà„É¨„ÇπÂûã',
                    description: '„ÅÇ„Å™„Åü„ÅØËÅ∑Â†¥„ÅÆ‰∫∫ÈñìÈñ¢‰øÇ„Åå‰∏ª„Å™„Çπ„Éà„É¨„ÇπÊ∫ê„Åß„Åô„ÄÇ„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥ÊîπÂñÑ„Å®Â¢ÉÁïåÁ∑öË®≠ÂÆö„Å´Âèñ„ÇäÁµÑ„Çì„Åß„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ'
                },
                C: {
                    name: 'üìà Ë©ï‰æ°‰∏çÊ∫ÄÂûã',
                    description: '„ÅÇ„Å™„Åü„ÅØË©ï‰æ°„ÇÑÂ†±ÈÖ¨„Å∏„ÅÆ‰∏çÊ∫Ä„Åå‰∏ª„Å™ÂéüÂõ†„Åß„Åô„ÄÇÊàêÊûú„ÅÆÂèØË¶ñÂåñ„Å®‰∏äÂè∏„Å®„ÅÆÂØæË©±„ÇíÈáçË¶ñ„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ'
                },
                D: {
                    name: 'üéØ ‰ªï‰∫ãÂÜÖÂÆπ„Éü„Çπ„Éû„ÉÉ„ÉÅÂûã',
                    description: '„ÅÇ„Å™„Åü„ÅØ‰ªï‰∫ãÂÜÖÂÆπ„Å∏„ÅÆ‰∏çÊ∫Ä„Åå‰∏ª„Å™ÂéüÂõ†„Åß„Åô„ÄÇÊÄùËÄÉ„ÅÆ„Çπ„Ç§„ÉÉ„ÉÅ„ÇíÂàá„ÇäÊõø„Åà„Å¶„ÄÅ‰ªï‰∫ã„Å´Êñ∞„Åü„Å™ÊÑèÂë≥„ÇíË¶ãÂá∫„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ'
                }
            };

            const result = document.getElementById('result');
            const resultType = document.getElementById('result-type');
            const resultDescription = document.getElementById('result-description');
            const diagnosisResultInput = document.getElementById('diagnosis-result');

            resultType.textContent = `„ÅÇ„Å™„Åü„ÅÆ„Çø„Ç§„Éó: ${typeDescriptions[maxType].name}`;
            resultDescription.textContent = typeDescriptions[maxType].description;
            diagnosisResultInput.value = typeDescriptions[maxType].name;

            result.style.display = 'block';
            result.classList.add('fade-in');
        }

        function saveSheet() {
            const todoInputs = document.querySelectorAll('.todo-input');
            const weekActions = [];
            const monthActions = [];
            
            // ‰ªäÈÄ±„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥ÔºàÊúÄÂàù„ÅÆ3„Å§Ôºâ
            for(let i = 0; i < 3; i++) {
                if(todoInputs[i] && todoInputs[i].value.trim()) {
                    weekActions.push(todoInputs[i].value.trim());
                }
            }
            
            // ‰ªäÊúà„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥ÔºàÊ¨°„ÅÆ2„Å§Ôºâ
            for(let i = 3; i < 5; i++) {
                if(todoInputs[i] && todoInputs[i].value.trim()) {
                    monthActions.push(todoInputs[i].value.trim());
                }
            }

            const formData = {
                diagnosisResult: document.getElementById('diagnosis-result').value,
                mainCauses: document.getElementById('main-causes').value,
                idealState: document.getElementById('ideal-state').value,
                measurement: document.getElementById('measurement').value,
                supportPerson: document.getElementById('support-person').value,
                reportDate: document.getElementById('report-date').value,
                weekActions: weekActions,
                monthActions: monthActions
            };

            const content = `„ÇÑ„ÇãÊ∞óÂõûÂæ©„Éó„É©„É≥„Éã„É≥„Ç∞„Ç∑„Éº„Éà
            
Ë®∫Êñ≠„Çø„Ç§„Éó: ${formData.diagnosisResult}
‰∏ª„Å™ÂéüÂõ†: ${formData.mainCauses}
1„É∂ÊúàÂæå„ÅÆÁêÜÊÉ≥Áä∂ÊÖã: ${formData.idealState}
ÈÅîÊàêÂ∫¶Ê∏¨ÂÆöÊñπÊ≥ï: ${formData.measurement}

‰ªäÈÄ±ÂÆüË∑µ„Åô„Çã„Åì„Å®:
${formData.weekActions.map((action, index) => `${index + 1}. ${action}`).join('\n')}

‰ªäÊúàÂèñ„ÇäÁµÑ„ÇÄ„Åì„Å®:
${formData.monthActions.map((action, index) => `${index + 1}. ${action}`).join('\n')}

Áõ∏Ë´áÁõ∏Êâã: ${formData.supportPerson}
ÈÄ≤ÊçóÂ†±ÂëäÊó•: ${formData.reportDate}

‰ΩúÊàêÊó•: ${new Date().toLocaleDateString('ja-JP')}`;

            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = '„ÇÑ„ÇãÊ∞óÂõûÂæ©„Éó„É©„É≥.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('„Éó„É©„É≥„Åå‰øùÂ≠ò„Åï„Çå„Åæ„Åó„ÅüÔºÅÂÆöÊúüÁöÑ„Å´Ë¶ãÁõ¥„Åó„Å¶„ÄÅ„ÇÑ„ÇãÊ∞óÂõûÂæ©„Å´ÂΩπÁ´ã„Å¶„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
        }

        // „ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„Å´„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÂäπÊûú„ÇíËøΩÂä†
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                if (this.checked) {
                    this.parentElement.style.backgroundColor = '#e8f5e8';
                } else {
                    this.parentElement.style.backgroundColor = '';
                }
            });
        });
    </script>
</body>
</html>